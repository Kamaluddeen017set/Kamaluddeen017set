<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taxi Admin Dashboard</title>
    <style>
      /* General Styles */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    display: flex;
    height: 100vh;
    color: #333;
}
#map-container {
    position: relative;
    padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
    height: 0;
    overflow: hidden;
}
#map-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}
.dashboard {
    display: flex;
    width: 100%;
}

/* Sidebar */
.sidebar {
    width: 20%;
    background-color: #282c34;
    color: #fff;
    padding: 20px;
}

.sidebar h2 {
    text-align: center;
}

.sidebar ul {
    list-style: none;
    padding: 0;
}

.sidebar ul li {
    margin: 15px 0;
}

.sidebar ul li a {
    color: #fff;
    text-decoration: none;
}

.sidebar ul li a:hover {
    text-decoration: underline;
}

/* Main Content */
.content {
    flex: 1;
    padding: 20px;
    background-color: #f7f7f7;
}

.topbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    background-color: #ddd;
}

.cards {
    display: flex;
    justify-content: space-between;
    margin-top: 20px;
}

.card {
    background: #fff;
    padding: 20px;
    text-align: center;
    border-radius: 5px;
    flex: 1;
    margin: 0 10px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* Table */
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

th, td {
    border: 1px solid #ddd;
    padding: 10px;
    text-align: center;
}

/* Driver Tracking */
#map {
    background: #e0e0e0;
    height: 300px;
    margin-top: 20px;
    border-radius: 5px;
}
    </style>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <div class="dashboard">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h2>Taxi Admin</h2>
            <nav>
                <ul>
                    <li><a href="#overview">Overview</a></li>
                    <li><a href="#payment">Payment Processing</a></li>
                    <li><a href="#driverTracking">Driver Tracking</a></li>
                    <li><a href="#vehicleMaintenance">Vehicle Maintenance</a></li>
                    <li><a href="#rideScheduling">Ride Scheduling</a></li>
                    <li><a href="#rideRequests">Ride Request Management</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <header class="topbar">
                <h1>Welcome, Admin</h1>
                <button id="addRideBtn">Add Ride</button>
            </header>

            <!-- Overview Section -->
            <section id="overview" class="cards">
                <div class="card">
                    <h3>Total Rides</h3>
                    <p id="totalRides">2500</p>
                </div>
                <div class="card">
                    <h3>Active Drivers</h3>
                    <p id="activeDrivers">150</p>
                </div>
                <div class="card">
                    <h3>Revenue</h3>
                    <p id="revenue">$500,000</p>
                </div>
                <div class="card">
                    <h3>Pending Requests</h3>
                    <p id="pendingRequests">45</p>
                </div>
            </section>

            <!-- Payment Processing -->
            <section id="payment">
                <h2>Payment Processing</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Transaction ID</th>
                            <th>Customer</th>
                            <th>Amount</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>TX12345</td>
                            <td>John Doe</td>
                            <td>$50</td>
                            <td>Completed</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Driver Tracking -->
            <section id="driverTracking">
                <h2>Driver Tracking</h2>
                <div id="tracking-section">
    <h3>Driver Tracking</h3>
    <form id="tracking-form">
        <label for="tracking-id">Enter Tracking ID:</label>
        <input type="text" id="tracking-id" placeholder="Enter Driver ID" />
        <button type="submit">Track</button>
    </form>
    <div id="map" style="height: 400px; width: 100%; margin-top: 20px;"></div>
</div>
               <div id="map-container">
    <iframe 
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3153.8354345084285!2d-122.41941568468242!3d37.77492927975964!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x80858064d6c0bb1f%3A0xdb0e89b45392d5!2sSan%20Francisco%2C%20CA%2C%20USA!5e0!3m2!1sen!2s!4v1694629170629!5m2!1sen!2s" 
        width="100%" 
        height="400px" 
        style="border:0;" 
        allowfullscreen="" 
        loading="lazy" 
        referrerpolicy="no-referrer-when-downgrade">
    </iframe>
</div>
            </section>

            <!-- Vehicle Maintenance -->
            <section id="vehicleMaintenance">
                <h2>Vehicle Maintenance</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Vehicle ID</th>
                            <th>Model</th>
                            <th>Status</th>
                            <th>Last Service</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>V001</td>
                            <td>Toyota Prius</td>
                            <td>Operational</td>
                            <td>2024-10-01</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Ride Scheduling -->
            <section id="rideScheduling">
                <h2>Ride Scheduling</h2>
                <button id="scheduleRideBtn">Schedule Ride</button>
            </section>

            <!-- Ride Request Management -->
            <section id="rideRequests">
                <h2>Ride Request Management</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Request ID</th>
                            <th>Customer</th>
                            <th>Pickup</th>
                            <th>Dropoff</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>REQ101</td>
                            <td>Jane Smith</td>
                            <td>City Center</td>
                            <td>Airport</td>
                            <td>Pending</td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </main>
    </div>

    <script src="script.js"></script>
</body>
<script>
  // Placeholder Driver Locations (for tracking)
  const driverLocations = [
    { id: "Driver001", name: "John Doe", location: "Downtown" },
    { id: "Driver002", name: "Jane Smith", location: "City Center" },
    { id: "Driver003", name: "Mark Lee", location: "Suburbs" },
  ];
  
  // Add Ride Functionality
  const addRideBtn = document.getElementById('addRideBtn');
  addRideBtn.addEventListener('click', () => {
    const rideId = `RID${Math.floor(Math.random() * 1000)}`;
    const customer = prompt("Enter Customer Name:");
    const pickup = prompt("Enter Pickup Location:");
    const dropoff = prompt("Enter Dropoff Location:");
    const status = "Scheduled";
  
    if (customer && pickup && dropoff) {
      const newRow = `
              <tr>
                  <td>${rideId}</td>
                  <td>${customer}</td>
                  <td>${pickup}</td>
                  <td>${dropoff}</td>
                  <td>${status}</td>
              </tr>
          `;
      document.querySelector("#rideRequests table tbody").innerHTML += newRow;
      alert(`Ride ${rideId} added successfully!`);
    } else {
      alert("All fields are required to add a ride.");
    }
  });
  
  // Schedule Ride Functionality
  const scheduleRideBtn = document.getElementById('scheduleRideBtn');
  scheduleRideBtn.addEventListener('click', () => {
    const driver = prompt("Assign a Driver Name:");
    const rideId = prompt("Enter Ride ID to Schedule:");
    if (driver && rideId) {
      alert(`Ride ${rideId} successfully scheduled with Driver ${driver}.`);
    } else {
      alert("Both Driver and Ride ID are required.");
    }
  });
  
  // Driver Tracking Functionality
  function displayDriverLocations() {
    const mapContainer = document.getElementById('map');
    mapContainer.innerHTML = "";
    driverLocations.forEach((driver) => {
      const driverDiv = document.createElement('div');
      driverDiv.textContent = `${driver.name} - ${driver.location}`;
      driverDiv.style.padding = "10px";
      driverDiv.style.background = "#fff";
      driverDiv.style.marginBottom = "5px";
      driverDiv.style.borderRadius = "5px";
      driverDiv.style.boxShadow = "0 2px 4px rgba(0, 0, 0, 0.1)";
      mapContainer.appendChild(driverDiv);
    });
  }
  document.addEventListener('DOMContentLoaded', displayDriverLocations);
  
  // Update Payment Status
  function updatePaymentStatus(transactionId, newStatus) {
    const rows = document.querySelectorAll("#payment table tbody tr");
    rows.forEach((row) => {
      if (row.cells[0].textContent === transactionId) {
        row.cells[3].textContent = newStatus;
        alert(`Transaction ${transactionId} updated to ${newStatus}`);
      }
    });
  }
  
  // Example: Update Payment Status (demo)
  document.addEventListener("DOMContentLoaded", () => {
    setTimeout(() => {
      updatePaymentStatus("TX12345", "Refunded");
    }, 5000); // Automatically updates after 5 seconds for demonstration
  });
  
  // Vehicle Maintenance Status Update
  function updateVehicleMaintenance(vehicleId, newStatus) {
    const rows = document.querySelectorAll("#vehicleMaintenance table tbody tr");
    rows.forEach((row) => {
      if (row.cells[0].textContent === vehicleId) {
        row.cells[2].textContent = newStatus;
        alert(`Vehicle ${vehicleId} status updated to ${newStatus}`);
      }
    });
  }
  
  // Example: Update Vehicle Maintenance (demo)
  document.addEventListener("DOMContentLoaded", () => {
    setTimeout(() => {
      updateVehicleMaintenance("V001", "Under Maintenance");
    }, 7000); // Automatically updates after 7 seconds for demonstration
  });
  // Initialize Leaflet Map
  const map = L.map('map').setView([40.73061, -73.935242], 12); // Default view: New York City
  
  // Add OpenStreetMap Tiles
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap contributors'
  }).addTo(map);
  
  // Driver Locations Array
  const driverLocations = [
    { id: "Driver001", name: "John Doe", coords: [40.73061, -73.935242] },
    { id: "Driver002", name: "Jane Smith", coords: [40.74061, -73.945242] },
    { id: "Driver003", name: "Mark Lee", coords: [40.75061, -73.955242] },
  ];
  
  // Add Markers for Drivers
  driverLocations.forEach((driver) => {
    const marker = L.marker(driver.coords).addTo(map);
    marker.bindPopup(`<b>${driver.name}</b><br>Driver ID: ${driver.id}`);
  });
  // Initialize the map
const map = L.map('map').setView([40.73061, -73.935242], 12);

// Add OpenStreetMap tiles
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap contributors'
}).addTo(map);

// Object to store driver markers
const driverMarkers = {};

// Function to fetch and update driver locations
function updateDriverLocations() {
    fetch('https://your-backend-url.com/api/drivers') // Replace with your backend URL
        .then(response => response.json())
        .then(data => {
            data.forEach(driver => {
                if (driverMarkers[driver.id]) {
                    // Update marker position
                    driverMarkers[driver.id].setLatLng([driver.latitude, driver.longitude]);
                } else {
                    // Create a new marker if it doesn't exist
                    const marker = L.marker([driver.latitude, driver.longitude]).addTo(map);
                    marker.bindPopup(`<b>${driver.name}</b><br>Driver ID: ${driver.id}`);
                    driverMarkers[driver.id] = marker;
                }
            });
        })
        .catch(error => console.error('Error fetching driver locations:', error));
}

// Update driver locations every 5 seconds
setInterval(updateDriverLocations, 5000);

// Initial fetch
updateDriverLocations();
const express = require('express');
const app = express();

app.get('/api/drivers', (req, res) => {
  const drivers = [
    { id: "Driver001", name: "John Doe", latitude: 40.73061, longitude: -73.935242 },
    { id: "Driver002", name: "Jane Smith", latitude: 40.74061, longitude: -73.945242 }
    ];
  res.json(drivers);
});

app.listen(3000, () => console.log('Server running on port 3000'));
let drivers = [
    { id: "Driver001", name: "John Doe", latitude: 40.73061, longitude: -73.935242 },
    { id: "Driver002", name: "Jane Smith", latitude: 40.74061, longitude: -73.945242 }
];

setInterval(() => {
    drivers = drivers.map(driver => ({
        ...driver,
        latitude: driver.latitude + (Math.random() - 0.5) * 0.01,
        longitude: driver.longitude + (Math.random() - 0.5) * 0.01
    }));
}, 5000);
// Initialize the map
const map = L.map('map').setView([40.73061, -73.935242], 12);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap contributors'
}).addTo(map);

// Marker for the tracked driver
let trackedMarker = null;

// Function to fetch and track a specific driver
function trackDriver(driverId) {
  fetch(`https://your-backend-url.com/api/driver/${driverId}`) // Replace with your backend URL
    .then(response => {
      if (!response.ok) throw new Error('Driver not found');
      return response.json();
    })
    .then(driver => {
      const { latitude, longitude, name } = driver;

      // Update or create marker
      if (trackedMarker) {
        trackedMarker.setLatLng([latitude, longitude]);
      } else {
        trackedMarker = L.marker([latitude, longitude]).addTo(map);
        trackedMarker.bindPopup(`<b>${name}</b><br>Driver ID: ${driverId}`);
      }

      // Center map on the driver's location
      map.setView([latitude, longitude], 14);
    })
    .catch(error => {
      alert('Error: ' + error.message);
    });
}

// Handle form submission
document.getElementById('tracking-form').addEventListener('submit', function(event) {
  event.preventDefault();
  const driverId = document.getElementById('tracking-id').value.trim();
  if (driverId) {
    trackDriver(driverId); // Call the tracking function with the entered ID
  } else {
    alert('Please enter a valid Tracking ID');
  }
});

// Optional: Auto-refresh the tracked driver's location every 5 seconds
setInterval(() => {
  const driverId = document.getElementById('tracking-id').value.trim();
  if (driverId) {
    trackDriver(driverId);
  }
}, 5000);
</script>
</html>